kind: pipeline
type: docker
name: default

# windows required
platform:
  os: windows
  arch: amd64
  # version: "1903"

steps:
  - name: build
    image: mcr.microsoft.com/dotnet/framework/sdk:4.8
    commands:
      - powershell
      #
      - curl.exe -o nuget.exe https://dist.nuget.org/win-x86-commandline/latest/nuget.exe
      - nuget restore WebApplication1.sln
      #
      - msbuild "WebApplication1\WebApplication1.csproj" /p:Configuration=Release -r:False /p:DeployOnBuild=True /p:DeployDefaultTarget=WebPublish /p:WebPublishMethod=FileSystem /p:DeleteExistingFiles=True /p:publishUrl=../output
      - ls ./output

  - name: docker-build
    image: docker:dind
    commands:
      - docker info
